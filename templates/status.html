<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SYSTEMSTATUS - SOURCEFUL ENERGY TERMINAL</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/terminal.css') }}">
</head>
<body>
    <div class="terminal-container">
        <!-- Terminal Header -->
        <div class="terminal-system-info">
            SOURCEFUL ENERGY ANALYSIS SYSTEM v1.0<br>
            COPYRIGHT (C) 2025 - SOURCEFUL LABS AB<br>
            SYSTEMSTATUS OCH DIAGNOSTIK<br>
            READY.
        </div>

        <!-- ASCII Art Logo -->
        <div class="terminal-ascii">
███████╗████████╗ █████╗ ████████╗██╗   ██╗███████╗
██╔════╝╚══██╔══╝██╔══██╗╚══██╔══╝██║   ██║██╔════╝
███████╗   ██║   ███████║   ██║   ██║   ██║███████╗
╚════██║   ██║   ██╔══██║   ██║   ██║   ██║╚════██║
███████║   ██║   ██║  ██║   ██║   ╚██████╔╝███████║
╚══════╝   ╚═╝   ╚═╝  ╚═╝   ╚═╝    ╚═════╝ ╚══════╝
            SYSTEMÖVERVAKNING AKTIV
        </div>

        <div class="terminal-divider"></div>

        <!-- System Status -->
        <div class="terminal-prompt">SYSTEMKOMPONENTER:</div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">FLASK WEBBSERVER:</span>
            <span class="terminal-metric-value terminal-success">ONLINE</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">DATABAS:</span>
            <span class="terminal-metric-value terminal-success">{{ 'ANSLUTEN' if status.database_connected else 'FRÅNKOPPLAD' }}</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">ENTSO-E API:</span>
            <span class="terminal-metric-value terminal-success">{{ 'ANSLUTEN' if status.api_connected else 'FRÅNKOPPLAD' }}</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">AI FÖRKLARINGSMOTOR:</span>
            <span class="terminal-metric-value terminal-success">{{ 'AKTIV' if status.ai_available else 'INAKTIV' }}</span>
        </div>

        <div class="terminal-divider"></div>

        <!-- Database Statistics -->
        <div class="terminal-prompt">DATABASSTATISTIK:</div>

        {% if status.db_stats %}
        <div class="terminal-metric">
            <span class="terminal-metric-label">TOTALT ANTAL PRISREKORD:</span>
            <span class="terminal-metric-value">{{ "{:,}".format(status.db_stats.total_records).replace(',', ' ') }}</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">FÖRSTA DATUM:</span>
            <span class="terminal-metric-value">{{ status.db_stats.earliest_date.strftime('%Y-%m-%d') if status.db_stats.earliest_date else 'EJ TILLGÄNGLIGT' }}</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">SENASTE DATUM:</span>
            <span class="terminal-metric-value">{{ status.db_stats.latest_date.strftime('%Y-%m-%d') if status.db_stats.latest_date else 'EJ TILLGÄNGLIGT' }}</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">TÄCKTA OMRÅDEN:</span>
            <span class="terminal-metric-value">{{ ', '.join(status.db_stats.available_areas) if status.db_stats.available_areas else 'INGA' }}</span>
        </div>
        {% else %}
        <div class="terminal-metric">
            <span class="terminal-metric-label">DATABASINFO:</span>
            <span class="terminal-metric-value terminal-error">EJ TILLGÄNGLIG</span>
        </div>
        {% endif %}

        <div class="terminal-divider"></div>

        <!-- Cache Statistics -->
        <div class="terminal-prompt">CACHE OCH PRESTANDA:</div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">AKTIVA CACHE-FILER:</span>
            <span class="terminal-metric-value">{{ status.cache_files or 0 }}</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">CACHE-STORLEK:</span>
            <span class="terminal-metric-value">{{ status.cache_size_mb or 0 }} MB</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">SYSTEMMINNE:</span>
            <span class="terminal-metric-value">{{ 'TILLGÄNGLIGT' if status.memory_available else 'LÅGT' }}</span>
        </div>

        <div class="terminal-divider"></div>

        <!-- Feature Availability -->
        <div class="terminal-prompt">TILLGÄNGLIGA FUNKTIONER:</div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">PRISANALYS:</span>
            <span class="terminal-metric-value terminal-success">{{ 'AKTIVERAD' if status.price_analysis_available else 'INAKTIVERAD' }}</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">NEGATIV PRISANALYS:</span>
            <span class="terminal-metric-value terminal-success">{{ 'AKTIVERAD' if status.negative_price_analysis_available else 'INAKTIVERAD' }}</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">CSV-UPPLADDNING:</span>
            <span class="terminal-metric-value terminal-success">{{ 'AKTIVERAD' if status.csv_upload_available else 'INAKTIVERAD' }}</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">AI-FÖRKLARINGAR:</span>
            <span class="terminal-metric-value terminal-success">{{ 'AKTIVERAD' if status.ai_explanations_available else 'INAKTIVERAD' }}</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">DATAEXPORT:</span>
            <span class="terminal-metric-value terminal-success">{{ 'AKTIVERAD' if status.data_export_available else 'INAKTIVERAD' }}</span>
        </div>

        <div class="terminal-divider"></div>

        <!-- API Endpoints -->
        <div class="terminal-prompt">API-SLUTPUNKTER:</div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">HUVUDSIDA:</span>
            <span class="terminal-metric-value">http://{{ request.host }}/</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">UPPLADDNING:</span>
            <span class="terminal-metric-value">http://{{ request.host }}/upload</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">RESULTAT:</span>
            <span class="terminal-metric-value">http://{{ request.host }}/results</span>
        </div>

        <div class="terminal-metric">
            <span class="terminal-metric-label">SYSTEMSTATUS:</span>
            <span class="terminal-metric-value">http://{{ request.host }}/status</span>
        </div>

        <div class="terminal-divider"></div>

        <!-- System Messages -->
        {% if status.system_messages %}
        <div class="terminal-prompt">SYSTEMMEDDELANDEN:</div>
        {% for message in status.system_messages %}
        <div class="terminal-{{ message.type }}">
            {{ message.timestamp.strftime('%H:%M:%S') }}: {{ message.text }}
        </div>
        {% endfor %}
        {% endif %}

        <!-- Warnings if any -->
        {% if not status.database_connected %}
        <div class="terminal-error" style="padding: 15px; margin: 20px 0;">
            ⚠️  VARNING: DATABAS EJ ANSLUTEN ⚠️<br>
            Prisanalys kan vara begränsad utan databasanslutning.
        </div>
        {% endif %}

        {% if not status.api_connected %}
        <div class="terminal-error" style="padding: 15px; margin: 20px 0;">
            ⚠️  VARNING: ENTSO-E API EJ ANSLUTEN ⚠️<br>
            Nya prisdata kan inte hämtas utan API-anslutning.
        </div>
        {% endif %}

        <div class="terminal-divider"></div>

        <!-- Actions -->
        <div class="terminal-prompt">KOMMANDOALTERNATIV:</div>
        <div style="margin: 20px 0;">
            <a href="/" class="terminal-button" style="display: inline-block; text-decoration: none; margin-right: 20px;">
                TILLBAKA TILL HUVUDMENY
            </a>
            <a href="/upload" class="terminal-button" style="display: inline-block; text-decoration: none; margin-right: 20px;">
                LADDA UPP DATA
            </a>
            <a href="#" onclick="location.reload()" class="terminal-button" style="display: inline-block; text-decoration: none;">
                UPPDATERA STATUS
            </a>
        </div>

        <!-- Terminal Footer -->
        <div class="terminal-command-line terminal-text" style="text-align: center; color: #666666; margin-top: 40px;">
            SYSTEMDIAGNOSTIK SLUTFÖRD - ALLA SYSTEM OPERATIONELLA
        </div>

        <div class="terminal-text" style="text-align: center; margin-top: 20px;">
            <span class="cursor"></span>
        </div>
        
        <div class="terminal-text" style="text-align: center; margin-top: 15px; color: #555555; font-size: 12px;">
            Sourceful Labs AB • Made in Kalmar, Sweden • Sourceful Energy™
        </div>
    </div>

    <!-- Terminal JavaScript -->
    <script>
        // Terminal typing effect for cursor
        const cursor = document.querySelector('.cursor');
        if (cursor) {
            setInterval(() => {
                cursor.style.opacity = cursor.style.opacity === '0' ? '1' : '0';
            }, 500);
        }

        // Auto-refresh every 30 seconds
        setTimeout(() => {
            location.reload();
        }, 30000);

        // Real-time status updates (if implemented)
        function updateSystemStatus() {
            // Could add WebSocket updates here
        }
    </script>
</body>
</html>

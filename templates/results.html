<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANALYSRESULTAT - SOURCEFUL ENERGY TERMINAL</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/terminal.css') }}">
</head>
<body>
    <div class="terminal-container">
        <!-- Terminal Header -->
        <div class="terminal-system-info">
            SOURCEFUL ENERGY ANALYSIS SYSTEM v1.0<br>
            ANALYSRESULTAT GENERERAT<br>
            READY.
        </div>

        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="terminal-{{ 'error' if category == 'error' else 'success' if category == 'success' else 'info' }}">
                        {{ category.upper() }}: {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- ASCII Art Logo -->
        <div class="terminal-ascii">
‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë  ‚ïö‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù
‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë    ‚ïö‚ñà‚ñà‚ïî‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïê‚ñà‚ñà‚ïë
‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë
‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
            KOMPLETT ANALYS SLUTF√ñRD
        </div>

        <div class="terminal-divider"></div>

        <!-- AI Explanation Section -->
        {% if results and results.ai_explanation %}
        <div class="terminal-prompt">AI-ANALYS OCH INSIKTER:</div>
        <div class="terminal-text" style="background: rgba(0, 255, 0, 0.1); padding: 15px; margin: 10px 0; border-left: 3px solid #00ff00;">
            {{ results.ai_explanation | safe }}
        </div>
        <div class="terminal-divider"></div>
        {% endif %}

        <!-- Key Metrics -->
        <div class="terminal-prompt">HUVUDM√ÑTNINGAR:</div>
        
        {% if results and results.analysis %}
        <div class="terminal-metric">
            <span class="terminal-metric-label">TOTAL PRODUKTION:</span>
            <span class="terminal-metric-value">{{ "%.2f"|format(results.analysis.production_total) }} kWh</span>
        </div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">GENOMSNITTSPRIS:</span>
            <span class="terminal-metric-value">{{ "%.2f"|format(results.analysis.price_mean_eur_mwh) }} EUR/MWh</span>
        </div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">TOTAL INT√ÑKT:</span>
            <span class="terminal-metric-value">{{ "%.2f"|format(results.analysis.total_export_value_sek) }} SEK</span>
        </div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">GENOMSNITTLIG INT√ÑKT:</span>
            <span class="terminal-metric-value">{{ "%.4f"|format(results.analysis.total_export_value_sek / results.analysis.production_total) }} SEK/kWh</span>
        </div>

        <div class="terminal-divider"></div>

        <!-- Negative Price Analysis -->
        <div class="terminal-prompt">NEGATIVA PRISER ANALYS:</div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">TIMMAR MED NEGATIVA PRISER:</span>
            <span class="terminal-metric-value">{{ results.analysis.negative_price_hours }} av {{ results.analysis.total_hours }} timmar</span>
        </div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">ANDEL NEGATIVA PRISER:</span>
            <span class="terminal-metric-value">{{ "%.1f"|format((results.analysis.negative_price_hours / results.analysis.total_hours) * 100) }}%</span>
        </div>
        
        {% if results.analysis.negative_price_hours > 0 %}
        <div class="terminal-metric">
            <span class="terminal-metric-label">F√ñRLUST FR√ÖN NEGATIVA PRISER:</span>
            <span class="terminal-metric-value terminal-error">{{ "%.2f"|format(results.analysis.negative_export_cost_abs_sek) }} SEK</span>
        </div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">PRODUKTION VID NEGATIVA PRISER:</span>
            <span class="terminal-metric-value">{{ "%.2f"|format(results.analysis.production_during_negative_prices) }} kWh</span>
        </div>
        {% endif %}

        <div class="terminal-divider"></div>

        <!-- Price Statistics -->
        <div class="terminal-prompt">PRISSTATISTIK:</div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">H√ñGSTA PRIS:</span>
            <span class="terminal-metric-value">{{ "%.2f"|format(results.analysis.price_max_eur_mwh) }} EUR/MWh</span>
        </div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">L√ÑGSTA PRIS:</span>
            <span class="terminal-metric-value">{{ "%.2f"|format(results.analysis.price_min_eur_mwh) }} EUR/MWh</span>
        </div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">PRISVARIATION:</span>
            <span class="terminal-metric-value">{{ "%.4f"|format(results.analysis.price_volatility_std) }} SEK/kWh</span>
        </div>

        <div class="terminal-divider"></div>

        <!-- Time Period -->
        <div class="terminal-prompt">ANALYSPERIOD:</div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">STARTDATUM:</span>
            <span class="terminal-metric-value">{{ results.metadata.start_date[:10] if results.metadata.start_date else 'EJ SPECIFICERAT' }}</span>
        </div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">SLUTDATUM:</span>
            <span class="terminal-metric-value">{{ results.metadata.end_date[:10] if results.metadata.end_date else 'EJ SPECIFICERAT' }}</span>
        </div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">ELOMR√ÖDE:</span>
            <span class="terminal-metric-value">{{ results.metadata.area_code | upper }}</span>
        </div>
        
        <div class="terminal-metric">
            <span class="terminal-metric-label">VALUTA:</span>
            <span class="terminal-metric-value">{{ results.metadata.currency }}</span>
        </div>

        <div class="terminal-divider"></div>

        {% endif %}

        <!-- Warning if significant negative prices -->
        {% if results and results.analysis and results.analysis.negative_price_hours > 0 and (results.analysis.negative_price_hours / results.analysis.total_hours) > 0.05 %}
        <div class="terminal-error" style="padding: 15px; margin: 20px 0;">
            ‚ö†Ô∏è  VARNING: BETYDANDE NEGATIVA PRISER UPPT√ÑCKTA ‚ö†Ô∏è<br><br>
            Din anl√§ggning producerade under {{ "%.1f"|format((results.analysis.negative_price_hours / results.analysis.total_hours) * 100) }}% av tiden n√§r elpriserna var negativa.<br>
            Detta resulterade i en f√∂rlust p√• {{ "%.2f"|format(results.analysis.negative_export_cost_abs_sek) }} SEK.<br><br>
            REKOMMENDATION: √ñverv√§g batterilager eller produktionsstyrning.
        </div>
        {% endif %}

        <div class="terminal-divider"></div>

        <!-- Sourceful Energy Pitch -->
        <div class="terminal-prompt">SOURCEFUL ENERGY ZAP‚Ñ¢ - OPTIMERA DINA INT√ÑKTER:</div>
        
        <div class="terminal-text" style="background: rgba(255, 170, 0, 0.1); padding: 15px; margin: 10px 0; border-left: 3px solid #ffaa00;">
            <strong style="color: #ffaa00;">SOURCEFUL ENERGY ZAP‚Ñ¢</strong> kan hj√§lpa dig maximera dina int√§kter genom:<br><br>
            
            üîã <strong>INTELLIGENT BATTERILAGER</strong> - Lagra energi n√§r priserna √§r negativa eller l√•ga<br>
            üìä <strong>PREDIKTIV ANALYS</strong> - F√∂rutse prisfall och optimera produktion<br>
            ‚ö° <strong>AUTOMATISK STYRNING</strong> - Sl√§ng av produktionen n√§r det kostar pengar<br>
            üí∞ <strong>INT√ÑKTSOPTIMERING</strong> - S√§lj din lagrade energi n√§r priserna √§r h√∂ga<br><br>
            
            {% if results and results.analysis and results.analysis.negative_export_cost_abs_sek and results.analysis.negative_export_cost_abs_sek > 100 %}
            <span style="color: #00ff00;">POTENTIELL BESPARING: {{ "%.0f"|format(results.analysis.negative_export_cost_abs_sek) }} SEK/√•r med ZAP‚Ñ¢</span><br>
            {% endif %}
            
            <span style="color: #666666;">Kontakta oss f√∂r en kostnadsfri konsultation: info@sourceful.energy</span>
        </div>

        <div class="terminal-divider"></div>

        <!-- Actions -->
        <div class="terminal-prompt">KOMMANDOALTERNATIV:</div>
        <div style="margin: 20px 0;">
            <a href="/" class="terminal-button" style="display: inline-block; text-decoration: none; margin-right: 20px;">
                NY ANALYS
            </a>
            <a href="/status" class="terminal-button" style="display: inline-block; text-decoration: none; margin-right: 20px;">
                SYSTEMSTATUS
            </a>
            <a href="#" onclick="window.print()" class="terminal-button" style="display: inline-block; text-decoration: none;">
                SKRIV UT RAPPORT
            </a>
        </div>

        <!-- Data Download Option -->
        {% if results and results.metadata and results.metadata.session_id %}
        <div style="margin: 20px 0;">
            <a href="/download/{{ results.metadata.session_id }}" class="terminal-button" style="display: inline-block; text-decoration: none;">
                LADDA NER RAW DATA (CSV)
            </a>
        </div>
        {% endif %}

        <!-- Terminal Footer -->
        <div class="terminal-command-line terminal-text" style="text-align: center; color: #666666; margin-top: 40px;">
            ANALYS SLUTF√ñRD - SOURCEFUL ENERGY ZAP REDO F√ñR N√ÑSTA UPPDRAG
        </div>

        <div class="terminal-text" style="text-align: center; margin-top: 20px;">
            <span class="cursor"></span>
        </div>
    </div>

    <!-- Terminal JavaScript -->
    <script>
        // Terminal typing effect for cursor
        const cursor = document.querySelector('.cursor');
        if (cursor) {
            setInterval(() => {
                cursor.style.opacity = cursor.style.opacity === '0' ? '1' : '0';
            }, 500);
        }

        // Terminal sound effect (optional)
        function playTerminalSound() {
            // Could add a retro beep sound here
        }

        // Print function formatting
        window.addEventListener('beforeprint', function() {
            document.body.style.background = '#000';
            document.body.style.color = '#00ff00';
        });

        // Auto-scroll to top on load
        window.addEventListener('load', function() {
            window.scrollTo(0, 0);
        });
    </script>
</body>
</html>
